<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}ClearQ-Genz's way of learning{% endblock %}</title>
<link rel="icon" href="https://i.pinimg.com/736x/9e/c2/ae/9ec2aee8acfc8d708b140583868c7728.jpg" type="image/jpeg">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.tailwindcss.com https://cdnjs.cloudflare.com 'unsafe-inline'; style-src 'self' https://cdn.tailwindcss.com https://cdnjs.cloudflare.com 'unsafe-inline'; font-src 'self' https://cdnjs.cloudflare.com https://fonts.googleapis.com; img-src 'self' data: https:; connect-src 'self'">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <!-- Preconnect for CDN -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" 
          crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Custom CSS Variables with new theme colors */
        :root {
            --primary: #1f1f1f;
            --primary-hover: #000000;
            --primary-gradient: linear-gradient(135deg, #1f1f1f 0%, #ff6b4a 100%);
            --accent: #ff6b4a;
            --secondary: #2D3748;
            --dark: #151022;
            --text-body: #1f1f1f;
            --text-light: #555555;
            --bg-light: #fff5ec;
            --white: #ffffff;
            
            --border-radius: 0.25rem;
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.025);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.02);
            --shadow-color: rgba(31, 31, 31, 0.2);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: var(--text-body);
            background-color: var(--bg-light);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        h1, h2, h3, h4 {
            color: var(--primary);
            font-weight: 700;
            letter-spacing: -0.025em;
        }

        /* Focus styles for accessibility */
        :focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }

        .focus-visible {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }

        /* Skip to main content link for accessibility */
        .skip-to-content {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            z-index: 1001;
            text-decoration: none;
        }

        .skip-to-content:focus {
            top: 0;
        }

        /* Reduced motion preferences */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* Animation Classes */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease-out;
        }
        
        @media (prefers-reduced-motion: reduce) {
            .reveal {
                opacity: 1;
                transform: none;
            }
        }
        
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        .float-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        /* Custom Card Styling */
        .category-card {
            transition: var(--transition);
        }
        
        .category-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        @media (prefers-reduced-motion: reduce) {
            .category-card:hover {
                transform: none;
            }
        }

        /* Hero Background */
        .hero-bg {
            background: radial-gradient(circle at 80% 20%, rgba(255, 107, 74, 0.08) 0%, rgba(31, 31, 31, 0.03) 70%, transparent 100%);
        }

        /* Stats Counter */
        .stat-number {
            font-feature-settings: "tnum";
            font-variant-numeric: tabular-nums;
        }

        /* Mobile Menu */
        .mobile-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--white);
            box-shadow: var(--shadow-lg);
            z-index: 50;
        }
        
        .mobile-menu.active {
            display: block;
        }

        /* Loading indicator */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Notification styles */
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            z-index: 9999;
            animation: slideIn 0.3s ease-out;
            max-width: 350px;
        }
        
        .notification-success {
            background-color: #9CCB5C;
            color: #1f1f1f;
        }
        
        .notification-error {
            background-color: #FF3F1F;
            color: white;
        }
        
        .notification-info {
            background-color: #85C3EA;
            color: #1f1f1f;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .no-scrollbar::-webkit-scrollbar {
        display: none;
    }
    .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
    .scroll-smooth {
        scroll-behavior: smooth;
    }
    @media (max-width: 640px) {
        .mobile-horizontal-scroll {
            display: flex;
            flex-wrap: nowrap;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .mobile-horizontal-scroll > * {
            flex: 0 0 auto;
            width: 85%;
            margin-right: 1rem;
        }
        .mobile-horizontal-scroll > *:last-child {
            margin-right: 0;
        }
        .mobile-compact-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            grid-auto-rows: minmax(120px, auto);
        }
    }
    @media (min-width: 768px) {
        .mobile-compact-grid {
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            grid-auto-rows: minmax(140px, auto);
        }
    }
    
    @media (max-width: 767px) {
        .card-square-mobile {
            aspect-ratio: 1;
        }
        
        .card-tall-mobile {
            grid-row: span 2;
        }
        
        .card-wide-mobile {
            grid-column: span 2;
        }
    }
     @keyframes scroll {
        0% {
            transform: translateX(0);
        }
        100% {
            transform: translateX(calc(-350px * 5));
        }
    }
    
    .testimonial-scroll-container {
        display: flex;
        animation: scroll 40s linear infinite;
    }
    
    .testimonial-scroll-container:hover {
        animation-play-state: paused;
    }
    
    .animate-scroll {
        animation: scroll 40s linear infinite;
    }
    
    @media (max-width: 640px) {
        @keyframes scroll {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(calc(-300px * 5));
            }
        }
    }
    /* Optional: Add smooth transition for FAQ accordion */
    [class*="border border-light"] > button:focus + div,
    [class*="border border-light"] > button:active + div {
        transition: all 0.3s ease;
    }
    </style>
    
    <!-- Custom Tailwind Configuration -->
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#1f1f1f",
                        "primary-hover": "#000000",
                        "accent": "#ff6b4a",
                        "background-light": "#fff5ec",
                        "background-dark": "#151022",
                        "text-light": "#1f1f1f",
                        "text-dark": "#ffffff",
                        "text-secondary-light": "#555555",
                        "text-secondary-dark": "#a09db3",
                        "card-light": "#ffffff",
                        "card-dark": "#1e1a2e",
                        "border-light": "#E5E4E0",
                        "border-dark": "#2d2a3b",
                        "accent-beige": "#F0EFEA",
                        "secondary": "#2D3748",
                        "dark-card": "#232936",
                        "card-purple": "#E0DBFC",
                        "card-green": "#9CCB5C",
                        "card-blue": "#85C3EA",
                        "card-beige": "#EEE3CD",
                        "card-teal": "#A8E1E1",
                        "card-pink": "#F6D0CE",
                        "brand-red": "#FF3F1F",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "2xl": "1rem",
                        "full": "9999px"
                    },
                    fontSize: {
                        'xxs': '0.625rem',
                    },
                    backgroundImage: {
                        'gradient-primary': 'linear-gradient(135deg, #1f1f1f 0%, #ff6b4a 100%)',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'spin': 'spin 1s linear infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        spin: {
                            '0%': { transform: 'rotate(0deg)' },
                            '100%': { transform: 'rotate(360deg)' },
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-background-light flex flex-col min-h-screen">

    <!-- Skip to main content (Accessibility) -->
    <a href="#main-content" class="skip-to-content">Skip to main content</a>

    <!-- Modern Header -->
    <header id="mainHeader" class="bg-white/85 backdrop-blur-xl sticky top-0 z-50 border-b border-light">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <a href="/" class="flex-shrink-0 flex items-center space-x-2 focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 rounded-lg p-1">
                    <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-primary to-accent flex items-center justify-center">
                        <i class="fas fa-graduation-cap text-white text-sm" aria-hidden="true"></i>
                    </div>
                    <span class="text-xl font-bold text-primary">Clear<span class="text-accent">Q</span></span>
                </a>

                <!-- Desktop Navigation -->
                <nav class="hidden md:flex items-center space-x-8" aria-label="Main navigation">
                    <a href="/explore" 
                       class="text-secondary hover:text-accent font-medium transition-colors duration-300 focus:outline-none focus:text-accent">
                        Find Mentors
                    </a>
                    <a href="#how-it-works" 
                       class="text-secondary hover:text-accent font-medium transition-colors duration-300 focus:outline-none focus:text-accent">
                        How It Works
                    </a>
                    <a href="/mentorship-program" 
                       class="text-secondary hover:text-accent font-medium transition-colors duration-300 focus:outline-none focus:text-accent">
                        Program
                    </a>
                    
                    {% if current_user %}
                        <a href="/dashboard" 
                           class="text-secondary hover:text-accent font-medium transition-colors duration-300 focus:outline-none focus:text-accent">
                            Dashboard
                        </a>
                        {% if current_user.role == 'admin' %}
                            <a href="/admin/dashboard" 
                               class="text-secondary hover:text-accent font-medium transition-colors duration-300 focus:outline-none focus:text-accent">
                                Admin
                            </a>
                        {% endif %}
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2">
                                <!-- Same profile image for all users -->
                                <img src="https://cdn-icons-png.flaticon.com/512/5951/5951752.png" 
                                     alt="{{ current_user.full_name or current_user.username }}"
                                     class="w-8 h-8 rounded-full object-cover border-2 border-accent/20">
                                <span class="text-sm text-text-secondary-light">Hi, {{ current_user.full_name or current_user.username }}</span>
                            </div>
                            <a href="/logout" 
                               class="px-4 py-2 rounded-lg bg-gradient-to-r from-brand-red to-red-600 text-white font-medium hover:shadow-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-brand-red focus:ring-offset-2">
                                Logout
                            </a>
                        </div>
                    {% else %}
                        <div class="flex items-center space-x-4">
                            <a href="/login" 
                               class="px-4 py-2 rounded-lg border border-light text-secondary font-medium hover:bg-accent-beige transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2">
                                Log In
                            </a>
                            <a href="/register" 
                               class="px-4 py-2 rounded-lg bg-gradient-to-r from-primary to-accent text-white font-medium hover:shadow-lg hover:shadow-primary/25 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2">
                                Get Started
                            </a>
                        </div>
                    {% endif %}
                </nav>

                <!-- Mobile Menu Button -->
                <button id="mobileMenuButton" 
                        class="md:hidden text-secondary p-2 rounded-lg hover:bg-accent-beige focus:outline-none focus:ring-2 focus:ring-accent"
                        aria-label="Toggle mobile menu"
                        aria-expanded="false"
                        aria-controls="mobileMenu">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>

            <!-- Mobile Menu -->
            <div id="mobileMenu" 
                 class="mobile-menu md:hidden"
                 role="menu"
                 aria-label="Mobile navigation"
                 aria-hidden="true">
                <div class="py-4 space-y-3">
                    <a href="/explore" 
                       class="block py-2 text-secondary hover:text-accent px-4 rounded-lg hover:bg-accent-beige focus:outline-none focus:bg-accent-beige"
                       role="menuitem">
                        Find Mentors
                    </a>
                    <a href="#how-it-works" 
                       class="block py-2 text-secondary hover:text-accent px-4 rounded-lg hover:bg-accent-beige focus:outline-none focus:bg-accent-beige"
                       role="menuitem">
                        How It Works
                    </a>
                    <a href="/mentorship-program" 
                       class="block py-2 text-secondary hover:text-accent px-4 rounded-lg hover:bg-accent-beige focus:outline-none focus:bg-accent-beige"
                       role="menuitem">
                        Program
                    </a>
                    
                    {% if current_user %}
                        <a href="/dashboard" 
                           class="block py-2 text-secondary hover:text-accent px-4 rounded-lg hover:bg-accent-beige focus:outline-none focus:bg-accent-beige"
                           role="menuitem">
                            Dashboard
                        </a>
                        {% if current_user.role == 'admin' %}
                            <a href="/admin/dashboard" 
                               class="block py-2 text-secondary hover:text-accent px-4 rounded-lg hover:bg-accent-beige focus:outline-none focus:bg-accent-beige"
                               role="menuitem">
                                Admin
                            </a>
                        {% endif %}
                        <div class="pt-4 border-t border-light">
                            <div class="flex items-center space-x-3 mb-4 px-4">
                                <!-- Same profile image for all users (mobile) -->
                                <img src="https://cdn-icons-png.flaticon.com/512/5951/5951752.png" 
                                     alt="{{ current_user.full_name or current_user.username }}"
                                     class="w-10 h-10 rounded-full object-cover border-2 border-accent/20">
                                <div>
                                    <p class="font-medium text-primary">{{ current_user.full_name or current_user.username }}</p>
                                    <p class="text-sm text-text-secondary-light">{{ current_user.role|title }}</p>
                                </div>
                            </div>
                            <a href="/logout" 
                               class="block w-full text-center py-3 rounded-lg bg-gradient-to-r from-brand-red to-red-600 text-white font-medium mx-4 focus:outline-none focus:ring-2 focus:ring-brand-red focus:ring-offset-2"
                               role="menuitem">
                                Logout
                            </a>
                        </div>
                    {% else %}
                        <div class="pt-4 border-t border-light space-y-3">
                            <a href="/login" 
                               class="block w-full text-center py-3 rounded-lg border border-light text-secondary font-medium mx-4 hover:bg-accent-beige focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2"
                               role="menuitem">
                                Log In
                            </a>
                            <a href="/register" 
                               class="block w-full text-center py-3 rounded-lg bg-gradient-to-r from-primary to-accent text-white font-medium mx-4 hover:shadow-lg hover:shadow-primary/25 focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2"
                               role="menuitem">
                                Get Started
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content Block -->
    <main id="main-content" class="flex-grow" tabindex="-1">
        {% block content %}{% endblock %}
    </main>

    <!-- Enhanced Footer -->
    <footer class="bg-background-dark text-text-dark mt-16" role="contentinfo">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- Company Info -->
                <div>
                    <a href="/" class="flex items-center space-x-2 mb-6 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-background-dark rounded-lg p-1 inline-block">
                        <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-primary to-accent flex items-center justify-center">
                            <i class="fas fa-graduation-cap text-white" aria-hidden="true"></i>
                        </div>
                        <span class="text-xl font-bold text-white">Clear<span class="text-accent">Q</span></span>
                    </a>
                    <p class="text-text-secondary-dark mb-6 max-w-xs">
                        Democratizing mentorship for everyone. Connect with industry experts to accelerate your career growth.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" 
                           class="w-10 h-10 rounded-full bg-secondary hover:bg-primary-hover flex items-center justify-center transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-white"
                           aria-label="Twitter">
                            <i class="fab fa-twitter text-text-secondary-dark hover:text-white" aria-hidden="true"></i>
                        </a>
                        <a href="#" 
                           class="w-10 h-10 rounded-full bg-secondary hover:bg-primary-hover flex items-center justify-center transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-white"
                           aria-label="LinkedIn">
                            <i class="fab fa-linkedin-in text-text-secondary-dark hover:text-white" aria-hidden="true"></i>
                        </a>
                        <a href="#" 
                           class="w-10 h-10 rounded-full bg-secondary hover:bg-primary-hover flex items-center justify-center transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-white"
                           aria-label="Instagram">
                            <i class="fab fa-instagram text-text-secondary-dark hover:text-white" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div>
                    <h3 class="text-lg font-semibold mb-6">Quick Links</h3>
                    <ul class="space-y-3">
                        <li><a href="/explore" 
                               class="text-text-secondary-dark hover:text-white transition-colors duration-300 focus:outline-none focus:text-white">
                            Find Mentors
                        </a></li>
                        <li><a href="/register" 
                               class="text-text-secondary-dark hover:text-white transition-colors duration-300 focus:outline-none focus:text-white">
                            Become a Mentor
                        </a></li>
                        <li><a href="/mentorship-program" 
                               class="text-text-secondary-dark hover:text-white transition-colors duration-300 focus:outline-none focus:text-white">
                            Mentorship Program
                        </a></li>
                    </ul>
                </div>

                <!-- Resources -->
                <div>
                    <h3 class="text-lg font-semibold mb-6">Resources</h3>
                    <ul class="space-y-3">
                        <li><a href="#" 
                               class="text-text-secondary-dark hover:text-white transition-colors duration-300 focus:outline-none focus:text-white">
                            Career Guides
                        </a></li>
                        <li><a href="#" 
                               class="text-text-secondary-dark hover:text-white transition-colors duration-300 focus:outline-none focus:text-white">
                            Interview Prep
                        </a></li>
                        <li><a href="#" 
                               class="text-text-secondary-dark hover:text-white transition-colors duration-300 focus:outline-none focus:text-white">
                            FAQ
                        </a></li>
                    </ul>
                </div>

                <!-- Contact & Legal -->
                <div>
                    <h3 class="text-lg font-semibold mb-6">Contact & Legal</h3>
                    <ul class="space-y-3">
                        <li><a href="mailto:support@clearq.in" 
                               class="text-text-secondary-dark hover:text-white transition-colors duration-300 focus:outline-none focus:text-white">
                            support@clearq.in
                        </a></li>
                        <li><a href="/privacy" 
                               class="text-text-secondary-dark hover:text-white transition-colors duration-300 focus:outline-none focus:text-white">
                            Privacy Policy
                        </a></li>
                        <li><a href="/terms" 
                               class="text-text-secondary-dark hover:text-white transition-colors duration-300 focus:outline-none focus:text-white">
                            Terms of Service
                        </a></li>
                        <li><a href="#" 
                               class="text-text-secondary-dark hover:text-white transition-colors duration-300 focus:outline-none focus:text-white">
                            Cookie Policy
                        </a></li>
                    </ul>
                </div>
            </div>

            <!-- Copyright -->
            <div class="border-t border-dark mt-8 pt-8 text-center text-text-secondary-dark text-sm">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p>&copy; {{ now.year }} ClearQ.in. All rights reserved.</p>
                    <p class="mt-2 md:mt-0">
                        Made with <i class="fas fa-heart text-brand-red mx-1" aria-label="love"></i> for the community
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Ensure the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            
            // Mobile Menu Toggle with accessibility
            const mobileMenuButton = document.getElementById('mobileMenuButton');
            const mobileMenu = document.getElementById('mobileMenu');
            const menuIcon = mobileMenuButton ? mobileMenuButton.querySelector('i') : null;

            function toggleMobileMenu() {
                if (!mobileMenuButton || !mobileMenu) return;
                
                const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
                mobileMenu.classList.toggle('active');
                mobileMenu.setAttribute('aria-hidden', isExpanded);
                mobileMenuButton.setAttribute('aria-expanded', !isExpanded);
                
                if (mobileMenu.classList.contains('active')) {
                    if (menuIcon) {
                        menuIcon.classList.remove('fa-bars');
                        menuIcon.classList.add('fa-times');
                    }
                } else {
                    if (menuIcon) {
                        menuIcon.classList.remove('fa-times');
                        menuIcon.classList.add('fa-bars');
                    }
                }
            }

            if (mobileMenuButton) {
                mobileMenuButton.addEventListener('click', toggleMobileMenu);
                mobileMenuButton.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        toggleMobileMenu();
                    }
                });
            }

            // Close mobile menu when clicking outside
            document.addEventListener('click', function(event) {
                if (mobileMenu && mobileMenuButton && 
                    !mobileMenu.contains(event.target) && 
                    !mobileMenuButton.contains(event.target) && 
                    mobileMenu.classList.contains('active')) {
                    toggleMobileMenu();
                }
            });

            // Close mobile menu on escape key
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && mobileMenu && mobileMenu.classList.contains('active')) {
                    toggleMobileMenu();
                    if (mobileMenuButton) mobileMenuButton.focus();
                }
            });

            // Scroll animations with Intersection Observer
            const revealElements = document.querySelectorAll('.reveal');
            
            if (revealElements.length > 0 && 'IntersectionObserver' in window) {
                const revealObserver = new IntersectionObserver(function(entries) {
                    entries.forEach(function(entry) {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('active');
                            revealObserver.unobserve(entry.target);
                        }
                    });
                }, {
                    root: null,
                    rootMargin: '0px',
                    threshold: 0.1
                });

                revealElements.forEach(function(element) {
                    revealObserver.observe(element);
                });
            }

            // Smooth scroll for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(function(anchor) {
                anchor.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    
                    if (href === '#' || href === '#!') {
                        e.preventDefault();
                        return;
                    }
                    
                    const target = document.querySelector(href);
                    if (target) {
                        e.preventDefault();
                        
                        // Close mobile menu if open
                        if (mobileMenu && mobileMenu.classList.contains('active')) {
                            toggleMobileMenu();
                        }
                        
                        // Smooth scroll
                        const header = document.getElementById('mainHeader');
                        const headerHeight = header ? header.offsetHeight : 0;
                        const targetPosition = target.getBoundingClientRect().top + window.pageYOffset;
                        const offsetPosition = targetPosition - headerHeight - 20;
                        
                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });
                        
                        // Update URL without reloading
                        history.pushState(null, null, href);
                    }
                });
            });

            // Add focus-visible polyfill if needed
            if (!('focus-visible' in document.documentElement.classList)) {
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Tab') {
                        document.body.classList.add('focus-visible');
                    }
                });
                
                document.addEventListener('mousedown', function() {
                    document.body.classList.remove('focus-visible');
                });
            }

            // Notification system
            window.showNotification = function(message, type = 'info', duration = 3000) {
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas ${
                            type === 'success' ? 'fa-check-circle' :
                            type === 'error' ? 'fa-exclamation-circle' :
                            'fa-info-circle'
                        } mr-2"></i>
                        <span>${message}</span>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // Auto remove after duration
                setTimeout(() => {
                    notification.style.animation = 'slideIn 0.3s ease-out reverse';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, duration);
            };

            // Check for URL parameters for messages
            const urlParams = new URLSearchParams(window.location.search);
            const message = urlParams.get('message');
            const messageType = urlParams.get('type');
            
            if (message) {
                showNotification(message, messageType || 'info');
                // Clean URL
                const cleanUrl = window.location.pathname;
                window.history.replaceState({}, document.title, cleanUrl);
            }
        });
    </script>
    
    {% block scripts %}{% endblock %}
</body>
</html>
