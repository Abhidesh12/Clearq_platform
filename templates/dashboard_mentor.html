{% extends "base.html" %}
{% block content %}
<h2>Mentor Dashboard</h2>
<p>Welcome, {{ current_user.full_name or current_user.email }}</p>
<p><strong>Earnings:</strong> ₹{{ earnings }}</p>
<h3>Your Services</h3>
<ul>
{% for s in services %}
<li>{{ s.name }} - ₹{{ s.price }} (<a href="/service/{{ s.id }}">view</a>)</li>
{% endfor %}
</ul>

<h3>Bookings</h3>
<table>
<tr><th>ID</th><th>Service</th><th>Learner</th><th>Date</th><th>Time</th><th>Status</th><th>Actions</th></tr>
{% for b in bookings %}
    <tr>
        <td>{{ b.id }}</td>
        <td>{{ b.service_name }}</td>
        <td>{{ b.learner_email }}</td>
        <td>{{ b.date }}</td>
        <td>{{ b.time }}</td>
        <td>{{ b.status }}</td>
        <td>
            {% if b.status != 'completed' and b.status != 'cancelled' %}
            <form action="/mentor/booking/{{ b.id }}/complete" method="post" style="display:inline-block;margin-right:0.5rem;">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                <button type="submit">Mark Completed</button>
            </form>
            <form action="/mentor/booking/{{ b.id }}/cancel" method="post" style="display:inline-block;">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                <button type="submit">Cancel</button>
            </form>
            {% else %}
            —
            {% endif %}
        </td>
    </tr>
{% endfor %}
</table>
{% endblock %}